{"ast":null,"code":"'use strict';\n\nvar asLocalTrack = require('./util').asLocalTrack;\n\nvar buildLogLevels = require('./util').buildLogLevels;\n\nvar getUserMedia = require('@twilio/webrtc').getUserMedia;\n\nvar _require = require('./media/track/es5'),\n    LocalAudioTrack = _require.LocalAudioTrack,\n    LocalDataTrack = _require.LocalDataTrack,\n    LocalVideoTrack = _require.LocalVideoTrack;\n\nvar MediaStreamTrack = require('@twilio/webrtc').MediaStreamTrack;\n\nvar Log = require('./util/log');\n\nvar DEFAULT_LOG_LEVEL = require('./util/constants').DEFAULT_LOG_LEVEL;\n\nvar workaround180748 = require('./webaudio/workaround180748'); // This is used to make out which createLocalTracks() call a particular Log\n// statement belongs to. Each call to createLocalTracks() increments this\n// counter.\n\n\nvar createLocalTrackCalls = 0;\n/**\r\n * Request {@link LocalTrack}s. By default, it requests a\r\n * {@link LocalAudioTrack} and a {@link LocalVideoTrack}.\r\n * @alias module:twilio-video.createLocalTracks\r\n * @param {CreateLocalTracksOptions} [options]\r\n * @returns {Promise<Array<LocalTrack>>}\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request audio and video tracks\r\n * Video.createLocalTracks().then(function(localTracks) {\r\n *   var localMediaContainer = document.getElementById('local-media-container-id');\r\n *   localTracks.forEach(function(track) {\r\n *     localMediaContainer.appendChild(track.attach());\r\n *   });\r\n * });\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request just the default audio track\r\n * Video.createLocalTracks({ audio: true }).then(function(localTracks) {\r\n *   return Video.connect('my-token', {\r\n *     name: 'my-cool-room',\r\n *     tracks: localTracks\r\n *   });\r\n * });\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request the audio and video tracks with custom names\r\n * Video.createLocalTracks({\r\n *   audio: { name: 'microphone' },\r\n *   video: { name: 'camera' }\r\n * }).then(function(localTracks) {\r\n *   localTracks.forEach(function(localTrack) {\r\n *     console.log(localTrack.name);\r\n *   });\r\n * });\r\n */\n\nfunction createLocalTracks(options) {\n  var isAudioVideoAbsent = !(options && ('audio' in options || 'video' in options));\n  options = Object.assign({\n    audio: isAudioVideoAbsent,\n    getUserMedia: getUserMedia,\n    logLevel: DEFAULT_LOG_LEVEL,\n    LocalAudioTrack: LocalAudioTrack,\n    LocalDataTrack: LocalDataTrack,\n    LocalVideoTrack: LocalVideoTrack,\n    MediaStreamTrack: MediaStreamTrack,\n    Log: Log,\n    video: isAudioVideoAbsent\n  }, options);\n  var logComponentName = '[createLocalTracks #' + ++createLocalTrackCalls + ']';\n  var logLevels = buildLogLevels(options.logLevel);\n  var log = new options.Log('default', logComponentName, logLevels); // NOTE(mmalavalli): The Room \"name\" in \"options\" was being used\n  // as the LocalTrack name in asLocalTrack(). So we pass a copy of\n  // \"options\" without the \"name\".\n\n  var localTrackOptions = Object.assign({\n    log: log\n  }, options);\n  delete localTrackOptions.name;\n\n  if (options.audio === false && options.video === false) {\n    log.info('Neither audio nor video requested, so returning empty LocalTracks');\n    return Promise.resolve([]);\n  }\n\n  if (options.tracks) {\n    log.info('Adding user-provided LocalTracks');\n    log.debug('LocalTracks:', options.tracks);\n    return Promise.resolve(options.tracks);\n  }\n\n  var localTrackNameOptions = {\n    audio: options.audio && options.audio.name ? {\n      name: options.audio.name\n    } : {},\n    video: options.video && options.video.name ? {\n      name: options.video.name\n    } : {}\n  };\n\n  if (options.audio) {\n    delete options.audio.name;\n  }\n\n  if (options.video) {\n    delete options.video.name;\n  }\n\n  var mediaStreamConstraints = {\n    audio: options.audio,\n    video: options.video\n  };\n  var workaroundWebKitBug180748 = options.audio && options.audio.workaroundWebKitBug180748;\n  var mediaStreamPromise = workaroundWebKitBug180748 ? workaround180748(log, options.getUserMedia, mediaStreamConstraints) : options.getUserMedia(mediaStreamConstraints);\n  return mediaStreamPromise.then(function (mediaStream) {\n    var mediaStreamTracks = mediaStream.getAudioTracks().concat(mediaStream.getVideoTracks());\n    log.info('Call to getUserMedia successful; got MediaStreamTracks:', mediaStreamTracks);\n    return mediaStreamTracks.map(function (mediaStreamTrack) {\n      return asLocalTrack(mediaStreamTrack, Object.assign(localTrackNameOptions[mediaStreamTrack.kind], localTrackOptions));\n    });\n  }, function (error) {\n    log.warn('Call to getUserMedia failed:', error);\n    throw error;\n  });\n}\n/**\r\n * {@link createLocalTracks} options\r\n * @typedef {object} CreateLocalTracksOptions\r\n * @property {boolean|CreateLocalTrackOptions} [audio=true] - Whether or not to\r\n *   get local audio with <code>getUserMedia</code> when <code>tracks</code>\r\n *   are not provided.\r\n * @property {LogLevel|LogLevels} [logLevel='warn'] - Set the log verbosity\r\n *   of logging to console. Passing a {@link LogLevel} string will use the same\r\n *   level for all components. Pass a {@link LogLevels} to set specific log\r\n *   levels.\r\n * @property {boolean|CreateLocalTrackOptions} [video=true] - Whether or not to\r\n *   get local video with <code>getUserMedia</code> when <code>tracks</code>\r\n *   are not provided.\r\n */\n\n\nmodule.exports = createLocalTracks;","map":{"version":3,"sources":["C:/Users/khouloud/Documents/PI/MERN_Stack_PI/node_modules/twilio-video/es5/createlocaltracks.js"],"names":["asLocalTrack","require","buildLogLevels","getUserMedia","_require","LocalAudioTrack","LocalDataTrack","LocalVideoTrack","MediaStreamTrack","Log","DEFAULT_LOG_LEVEL","workaround180748","createLocalTrackCalls","createLocalTracks","options","isAudioVideoAbsent","Object","assign","audio","logLevel","video","logComponentName","logLevels","log","localTrackOptions","name","info","Promise","resolve","tracks","debug","localTrackNameOptions","mediaStreamConstraints","workaroundWebKitBug180748","mediaStreamPromise","then","mediaStream","mediaStreamTracks","getAudioTracks","concat","getVideoTracks","map","mediaStreamTrack","kind","error","warn","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar asLocalTrack = require('./util').asLocalTrack;\r\nvar buildLogLevels = require('./util').buildLogLevels;\r\nvar getUserMedia = require('@twilio/webrtc').getUserMedia;\r\n\r\nvar _require = require('./media/track/es5'),\r\n    LocalAudioTrack = _require.LocalAudioTrack,\r\n    LocalDataTrack = _require.LocalDataTrack,\r\n    LocalVideoTrack = _require.LocalVideoTrack;\r\n\r\nvar MediaStreamTrack = require('@twilio/webrtc').MediaStreamTrack;\r\nvar Log = require('./util/log');\r\nvar DEFAULT_LOG_LEVEL = require('./util/constants').DEFAULT_LOG_LEVEL;\r\nvar workaround180748 = require('./webaudio/workaround180748');\r\n\r\n// This is used to make out which createLocalTracks() call a particular Log\r\n// statement belongs to. Each call to createLocalTracks() increments this\r\n// counter.\r\nvar createLocalTrackCalls = 0;\r\n\r\n/**\r\n * Request {@link LocalTrack}s. By default, it requests a\r\n * {@link LocalAudioTrack} and a {@link LocalVideoTrack}.\r\n * @alias module:twilio-video.createLocalTracks\r\n * @param {CreateLocalTracksOptions} [options]\r\n * @returns {Promise<Array<LocalTrack>>}\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request audio and video tracks\r\n * Video.createLocalTracks().then(function(localTracks) {\r\n *   var localMediaContainer = document.getElementById('local-media-container-id');\r\n *   localTracks.forEach(function(track) {\r\n *     localMediaContainer.appendChild(track.attach());\r\n *   });\r\n * });\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request just the default audio track\r\n * Video.createLocalTracks({ audio: true }).then(function(localTracks) {\r\n *   return Video.connect('my-token', {\r\n *     name: 'my-cool-room',\r\n *     tracks: localTracks\r\n *   });\r\n * });\r\n * @example\r\n * var Video = require('twilio-video');\r\n * // Request the audio and video tracks with custom names\r\n * Video.createLocalTracks({\r\n *   audio: { name: 'microphone' },\r\n *   video: { name: 'camera' }\r\n * }).then(function(localTracks) {\r\n *   localTracks.forEach(function(localTrack) {\r\n *     console.log(localTrack.name);\r\n *   });\r\n * });\r\n */\r\nfunction createLocalTracks(options) {\r\n  var isAudioVideoAbsent = !(options && ('audio' in options || 'video' in options));\r\n\r\n  options = Object.assign({\r\n    audio: isAudioVideoAbsent,\r\n    getUserMedia: getUserMedia,\r\n    logLevel: DEFAULT_LOG_LEVEL,\r\n    LocalAudioTrack: LocalAudioTrack,\r\n    LocalDataTrack: LocalDataTrack,\r\n    LocalVideoTrack: LocalVideoTrack,\r\n    MediaStreamTrack: MediaStreamTrack,\r\n    Log: Log,\r\n    video: isAudioVideoAbsent\r\n  }, options);\r\n\r\n  var logComponentName = '[createLocalTracks #' + ++createLocalTrackCalls + ']';\r\n  var logLevels = buildLogLevels(options.logLevel);\r\n  var log = new options.Log('default', logComponentName, logLevels);\r\n\r\n  // NOTE(mmalavalli): The Room \"name\" in \"options\" was being used\r\n  // as the LocalTrack name in asLocalTrack(). So we pass a copy of\r\n  // \"options\" without the \"name\".\r\n  var localTrackOptions = Object.assign({ log: log }, options);\r\n  delete localTrackOptions.name;\r\n\r\n  if (options.audio === false && options.video === false) {\r\n    log.info('Neither audio nor video requested, so returning empty LocalTracks');\r\n    return Promise.resolve([]);\r\n  }\r\n\r\n  if (options.tracks) {\r\n    log.info('Adding user-provided LocalTracks');\r\n    log.debug('LocalTracks:', options.tracks);\r\n    return Promise.resolve(options.tracks);\r\n  }\r\n\r\n  var localTrackNameOptions = {\r\n    audio: options.audio && options.audio.name ? { name: options.audio.name } : {},\r\n    video: options.video && options.video.name ? { name: options.video.name } : {}\r\n  };\r\n\r\n  if (options.audio) {\r\n    delete options.audio.name;\r\n  }\r\n  if (options.video) {\r\n    delete options.video.name;\r\n  }\r\n\r\n  var mediaStreamConstraints = {\r\n    audio: options.audio,\r\n    video: options.video\r\n  };\r\n\r\n  var workaroundWebKitBug180748 = options.audio && options.audio.workaroundWebKitBug180748;\r\n\r\n  var mediaStreamPromise = workaroundWebKitBug180748 ? workaround180748(log, options.getUserMedia, mediaStreamConstraints) : options.getUserMedia(mediaStreamConstraints);\r\n\r\n  return mediaStreamPromise.then(function (mediaStream) {\r\n    var mediaStreamTracks = mediaStream.getAudioTracks().concat(mediaStream.getVideoTracks());\r\n\r\n    log.info('Call to getUserMedia successful; got MediaStreamTracks:', mediaStreamTracks);\r\n\r\n    return mediaStreamTracks.map(function (mediaStreamTrack) {\r\n      return asLocalTrack(mediaStreamTrack, Object.assign(localTrackNameOptions[mediaStreamTrack.kind], localTrackOptions));\r\n    });\r\n  }, function (error) {\r\n    log.warn('Call to getUserMedia failed:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * {@link createLocalTracks} options\r\n * @typedef {object} CreateLocalTracksOptions\r\n * @property {boolean|CreateLocalTrackOptions} [audio=true] - Whether or not to\r\n *   get local audio with <code>getUserMedia</code> when <code>tracks</code>\r\n *   are not provided.\r\n * @property {LogLevel|LogLevels} [logLevel='warn'] - Set the log verbosity\r\n *   of logging to console. Passing a {@link LogLevel} string will use the same\r\n *   level for all components. Pass a {@link LogLevels} to set specific log\r\n *   levels.\r\n * @property {boolean|CreateLocalTrackOptions} [video=true] - Whether or not to\r\n *   get local video with <code>getUserMedia</code> when <code>tracks</code>\r\n *   are not provided.\r\n */\r\n\r\nmodule.exports = createLocalTracks;"]},"metadata":{},"sourceType":"script"}