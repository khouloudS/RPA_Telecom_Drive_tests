{"ast":null,"code":"'use strict';\n\nvar inherits = require('inherits'),\n    urlUtils = require('../../utils/url'),\n    BufferedSender = require('./buffered-sender'),\n    Polling = require('./polling');\n\nvar debug = function debug() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  debug = require('debug')('sockjs-client:sender-receiver');\n}\n\nfunction SenderReceiver(transUrl, urlSuffix, senderFunc, Receiver, AjaxObject) {\n  var pollUrl = urlUtils.addPath(transUrl, urlSuffix);\n  debug(pollUrl);\n  var self = this;\n  BufferedSender.call(this, transUrl, senderFunc);\n  this.poll = new Polling(Receiver, pollUrl, AjaxObject);\n  this.poll.on('message', function (msg) {\n    debug('poll message', msg);\n    self.emit('message', msg);\n  });\n  this.poll.once('close', function (code, reason) {\n    debug('poll close', code, reason);\n    self.poll = null;\n    self.emit('close', code, reason);\n    self.close();\n  });\n}\n\ninherits(SenderReceiver, BufferedSender);\n\nSenderReceiver.prototype.close = function () {\n  BufferedSender.prototype.close.call(this);\n  debug('close');\n  this.removeAllListeners();\n\n  if (this.poll) {\n    this.poll.abort();\n    this.poll = null;\n  }\n};\n\nmodule.exports = SenderReceiver;","map":{"version":3,"sources":["C:/Users/khouloud/Documents/PI/MERN_Stack_PI/node_modules/sockjs-client/lib/transport/lib/sender-receiver.js"],"names":["inherits","require","urlUtils","BufferedSender","Polling","debug","process","env","NODE_ENV","SenderReceiver","transUrl","urlSuffix","senderFunc","Receiver","AjaxObject","pollUrl","addPath","self","call","poll","on","msg","emit","once","code","reason","close","prototype","removeAllListeners","abort","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAtB;AAAA,IACIC,QAAQ,GAAGD,OAAO,CAAC,iBAAD,CADtB;AAAA,IAEIE,cAAc,GAAGF,OAAO,CAAC,mBAAD,CAF5B;AAAA,IAGIG,OAAO,GAAGH,OAAO,CAAC,WAAD,CAHrB;;AAMA,IAAII,KAAK,GAAG,iBAAW,CAAE,CAAzB;;AACA,IAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzCH,EAAAA,KAAK,GAAGJ,OAAO,CAAC,OAAD,CAAP,CAAiB,+BAAjB,CAAR;AACD;;AAED,SAASQ,cAAT,CAAwBC,QAAxB,EAAkCC,SAAlC,EAA6CC,UAA7C,EAAyDC,QAAzD,EAAmEC,UAAnE,EAA+E;AAC7E,MAAIC,OAAO,GAAGb,QAAQ,CAACc,OAAT,CAAiBN,QAAjB,EAA2BC,SAA3B,CAAd;AACAN,EAAAA,KAAK,CAACU,OAAD,CAAL;AACA,MAAIE,IAAI,GAAG,IAAX;AACAd,EAAAA,cAAc,CAACe,IAAf,CAAoB,IAApB,EAA0BR,QAA1B,EAAoCE,UAApC;AAEA,OAAKO,IAAL,GAAY,IAAIf,OAAJ,CAAYS,QAAZ,EAAsBE,OAAtB,EAA+BD,UAA/B,CAAZ;AACA,OAAKK,IAAL,CAAUC,EAAV,CAAa,SAAb,EAAwB,UAASC,GAAT,EAAc;AACpChB,IAAAA,KAAK,CAAC,cAAD,EAAiBgB,GAAjB,CAAL;AACAJ,IAAAA,IAAI,CAACK,IAAL,CAAU,SAAV,EAAqBD,GAArB;AACD,GAHD;AAIA,OAAKF,IAAL,CAAUI,IAAV,CAAe,OAAf,EAAwB,UAASC,IAAT,EAAeC,MAAf,EAAuB;AAC7CpB,IAAAA,KAAK,CAAC,YAAD,EAAemB,IAAf,EAAqBC,MAArB,CAAL;AACAR,IAAAA,IAAI,CAACE,IAAL,GAAY,IAAZ;AACAF,IAAAA,IAAI,CAACK,IAAL,CAAU,OAAV,EAAmBE,IAAnB,EAAyBC,MAAzB;AACAR,IAAAA,IAAI,CAACS,KAAL;AACD,GALD;AAMD;;AAED1B,QAAQ,CAACS,cAAD,EAAiBN,cAAjB,CAAR;;AAEAM,cAAc,CAACkB,SAAf,CAAyBD,KAAzB,GAAiC,YAAW;AAC1CvB,EAAAA,cAAc,CAACwB,SAAf,CAAyBD,KAAzB,CAA+BR,IAA/B,CAAoC,IAApC;AACAb,EAAAA,KAAK,CAAC,OAAD,CAAL;AACA,OAAKuB,kBAAL;;AACA,MAAI,KAAKT,IAAT,EAAe;AACb,SAAKA,IAAL,CAAUU,KAAV;AACA,SAAKV,IAAL,GAAY,IAAZ;AACD;AACF,CARD;;AAUAW,MAAM,CAACC,OAAP,GAAiBtB,cAAjB","sourcesContent":["'use strict';\r\n\r\nvar inherits = require('inherits')\r\n  , urlUtils = require('../../utils/url')\r\n  , BufferedSender = require('./buffered-sender')\r\n  , Polling = require('./polling')\r\n  ;\r\n\r\nvar debug = function() {};\r\nif (process.env.NODE_ENV !== 'production') {\r\n  debug = require('debug')('sockjs-client:sender-receiver');\r\n}\r\n\r\nfunction SenderReceiver(transUrl, urlSuffix, senderFunc, Receiver, AjaxObject) {\r\n  var pollUrl = urlUtils.addPath(transUrl, urlSuffix);\r\n  debug(pollUrl);\r\n  var self = this;\r\n  BufferedSender.call(this, transUrl, senderFunc);\r\n\r\n  this.poll = new Polling(Receiver, pollUrl, AjaxObject);\r\n  this.poll.on('message', function(msg) {\r\n    debug('poll message', msg);\r\n    self.emit('message', msg);\r\n  });\r\n  this.poll.once('close', function(code, reason) {\r\n    debug('poll close', code, reason);\r\n    self.poll = null;\r\n    self.emit('close', code, reason);\r\n    self.close();\r\n  });\r\n}\r\n\r\ninherits(SenderReceiver, BufferedSender);\r\n\r\nSenderReceiver.prototype.close = function() {\r\n  BufferedSender.prototype.close.call(this);\r\n  debug('close');\r\n  this.removeAllListeners();\r\n  if (this.poll) {\r\n    this.poll.abort();\r\n    this.poll = null;\r\n  }\r\n};\r\n\r\nmodule.exports = SenderReceiver;\r\n"]},"metadata":{},"sourceType":"script"}